YUI.add("datatable-scroll",function(S,t){var e=S.Lang,l=e.isString,i=e.isNumber,o=e.isArray;function g(t,e){return parseInt(t.getComputedStyle(e),10)||0}S.DataTable.Scrollable=e=function(){},e.ATTRS={scrollable:{value:!1,setter:"_setScrollable"}},S.mix(e.prototype,{scrollTo:function(t){var e;return t&&this._tbodyNode&&(this._yScrollNode||this._xScrollNode)&&(o(t)?e=this.getCell(t):i(t)?e=this.getRow(t):l(t)?e=this._tbodyNode.one("#"+t):t._node&&t.ancestor(".yui3-datatable")===this.get("boundingBox")&&(e=t),e&&e.scrollIntoView()),this},_CAPTION_TABLE_TEMPLATE:'<table class="{className}" role="presentation"></table>',_SCROLL_LINER_TEMPLATE:'<div class="{className}"></div>',_SCROLLBAR_TEMPLATE:'<div class="{className}"><div></div></div>',_X_SCROLLER_TEMPLATE:'<div class="{className}"></div>',_Y_SCROLL_HEADER_TEMPLATE:'<table cellspacing="0" aria-hidden="true" class="{className}"></table>',_Y_SCROLLER_TEMPLATE:'<div class="{className}"><div class="{scrollerClassName}"></div></div>',_addScrollbarPadding:function(){var t,e,l,i,o,s=this._yScrollHeader,r="."+this.getClassName("header");if(s)for(t=S.DOM.getScrollbarWidth()+"px",i=0,o=(e=s.all("tr")).size();i<o;i+=+l.get("rowSpan"))(l=e.item(i).all(r).pop()).setStyle("paddingRight",t)},_afterScrollableChange:function(){var t=this._xScrollNode;this._xScroll&&t&&(this._yScroll&&!this._yScrollNode?t.setStyle("paddingRight",S.DOM.getScrollbarWidth()+"px"):!this._yScroll&&this._yScrollNode&&t.setStyle("paddingRight","")),this._syncScrollUI()},_afterScrollCaptionChange:function(){(this._xScroll||this._yScroll)&&this._syncScrollUI()},_afterScrollColumnsChange:function(){(this._xScroll||this._yScroll)&&(this._yScroll&&this._yScrollHeader&&this._syncScrollHeaders(),this._syncScrollUI())},_afterScrollDataChange:function(){(this._xScroll||this._yScroll)&&this._syncScrollUI()},_afterScrollHeightChange:function(){this._yScroll&&this._syncScrollUI()},_afterScrollSort:function(){var l,t;this._yScroll&&this._yScrollHeader&&(t="."+this.getClassName("header"),l=this._theadNode.all(t),this._yScrollHeader.all(t).each(function(t,e){t.set("className",l.item(e).get("className"))}))},_afterScrollWidthChange:function(){(this._xScroll||this._yScroll)&&this._syncScrollUI()},_bindScrollbar:function(){var t=this._scrollbarNode,e=this._yScrollNode;t&&e&&!this._scrollbarEventHandle&&(this._scrollbarEventHandle=new S.Event.Handle([t.on("scroll",this._syncScrollPosition,this),e.on("scroll",this._syncScrollPosition,this)]))},_bindScrollResize:function(){this._scrollResizeHandle||(this._scrollResizeHandle=S.on("resize",this._syncScrollUI,null,this))},_bindScrollUI:function(){this.after({columnsChange:S.bind("_afterScrollColumnsChange",this),heightChange:S.bind("_afterScrollHeightChange",this),widthChange:S.bind("_afterScrollWidthChange",this),captionChange:S.bind("_afterScrollCaptionChange",this),scrollableChange:S.bind("_afterScrollableChange",this),sort:S.bind("_afterScrollSort",this)}),this.after(["dataChange","*:add","*:remove","*:reset","*:change"],S.bind("_afterScrollDataChange",this))},_clearScrollLock:function(){this._scrollLock&&(this._scrollLock.cancel(),delete this._scrollLock)},_createScrollbar:function(){var t=this._scrollbarNode;return t||(t=this._scrollbarNode=S.Node.create(S.Lang.sub(this._SCROLLBAR_TEMPLATE,{className:this.getClassName("scrollbar")}))).setStyle("width",S.DOM.getScrollbarWidth()+1+"px"),t},_createScrollCaptionTable:function(){return this._captionTable||(this._captionTable=S.Node.create(S.Lang.sub(this._CAPTION_TABLE_TEMPLATE,{className:this.getClassName("caption","table")})),this._captionTable.empty()),this._captionTable},_createXScrollNode:function(){return this._xScrollNode||(this._xScrollNode=S.Node.create(S.Lang.sub(this._X_SCROLLER_TEMPLATE,{className:this.getClassName("x","scroller")}))),this._xScrollNode},_createYScrollHeader:function(){return this._yScrollHeader||(this._yScrollHeader=S.Node.create(S.Lang.sub(this._Y_SCROLL_HEADER_TEMPLATE,{className:this.getClassName("scroll","columns")})))},_createYScrollNode:function(){var t;return this._yScrollNode||(t=this.getClassName("y","scroller"),this._yScrollContainer=S.Node.create(S.Lang.sub(this._Y_SCROLLER_TEMPLATE,{className:this.getClassName("y","scroller","container"),scrollerClassName:t})),this._yScrollNode=this._yScrollContainer.one("."+t)),this._yScrollContainer},_disableScrolling:function(){this._removeScrollCaptionTable(),this._disableXScrolling(),this._disableYScrolling(),this._unbindScrollResize(),this._uiSetWidth(this.get("width"))},_disableXScrolling:function(){this._removeXScrollNode()},_disableYScrolling:function(){this._removeYScrollHeader(),this._removeYScrollNode(),this._removeYScrollContainer(),this._removeScrollbar()},destructor:function(){this._unbindScrollbar(),this._unbindScrollResize(),this._clearScrollLock()},initializer:function(){this._setScrollProperties(),this.after(["scrollableChange","heightChange","widthChange"],this._setScrollProperties),this.after("renderView",S.bind("_syncScrollUI",this)),S.Do.after(this._bindScrollUI,this,"bindUI")},_removeScrollCaptionTable:function(){this._captionTable&&(this._captionNode&&this._tableNode.prepend(this._captionNode),this._captionTable.remove().destroy(!0),delete this._captionTable)},_removeXScrollNode:function(){var t=this._xScrollNode;t&&(t.replace(t.get("childNodes").toFrag()),t.remove().destroy(!0),delete this._xScrollNode)},_removeYScrollContainer:function(){var t=this._yScrollContainer;t&&(t.replace(t.get("childNodes").toFrag()),t.remove().destroy(!0),delete this._yScrollContainer)},_removeYScrollHeader:function(){this._yScrollHeader&&(this._yScrollHeader.remove().destroy(!0),delete this._yScrollHeader)},_removeYScrollNode:function(){var t=this._yScrollNode;t&&(t.replace(t.get("childNodes").toFrag()),t.remove().destroy(!0),delete this._yScrollNode)},_removeScrollbar:function(){this._scrollbarNode&&(this._scrollbarNode.remove().destroy(!0),delete this._scrollbarNode),this._scrollbarEventHandle&&(
this._scrollbarEventHandle.detach(),delete this._scrollbarEventHandle)},_setScrollable:function(t){return!1===(t=l(t=!0===t?"xy":t)?t.toLowerCase():t)||"y"===t||"x"===t||"xy"===t?t:S.Attribute.INVALID_VALUE},_setScrollProperties:function(){var t=this.get("scrollable")||"",e=this.get("width"),l=this.get("height");this._xScroll=e&&-1<t.indexOf("x"),this._yScroll=l&&-1<t.indexOf("y")},_syncScrollPosition:function(t){var e=this._scrollbarNode,l=this._yScrollNode,t=t.currentTarget;e&&l&&(this._scrollLock&&this._scrollLock.source!==t||(this._clearScrollLock(),this._scrollLock=S.later(300,this,this._clearScrollLock),((this._scrollLock.source=t)===e?l:e).set("scrollTop",t.get("scrollTop"))))},_syncScrollCaptionUI:function(){var t,e=this._captionNode,l=this._tableNode,i=this._captionTable;e?(t=e.getAttribute("id"),i||(i=this._createScrollCaptionTable(),this.get("contentBox").prepend(i)),e.get("parentNode").compareTo(i)||(i.empty().insert(e),t||(t=S.stamp(e),e.setAttribute("id",t)),l.setAttribute("aria-describedby",t))):i&&this._removeScrollCaptionTable()},_syncScrollColumnWidths:function(){var l=[];this._theadNode&&this._yScrollHeader&&(this._theadNode.all("."+this.getClassName("header")).each(function(t){l.push(S.UA.ie&&S.UA.ie<8?t.get("clientWidth")-g(t,"paddingLeft")-g(t,"paddingRight")+"px":t.getComputedStyle("width"))}),this._yScrollHeader.all("."+this.getClassName("scroll","liner")).each(function(t,e){t.setStyle("width",l[e])}))},_syncScrollHeaders:function(){var t=this._yScrollHeader,i=this._SCROLL_LINER_TEMPLATE,o=this.getClassName("scroll","liner"),e=this.getClassName("header"),s=this._theadNode.all("."+e);this._theadNode&&t&&(t.empty().appendChild(this._theadNode.cloneNode(!0)),t.all("[id]").removeAttribute("id"),t.all("."+e).each(function(t,e){var l=S.Node.create(S.Lang.sub(i,{className:o})),e=s.item(e);l.setStyle("padding",e.getComputedStyle("paddingTop")+" "+e.getComputedStyle("paddingRight")+" "+e.getComputedStyle("paddingBottom")+" "+e.getComputedStyle("paddingLeft")),l.appendChild(t.get("childNodes").toFrag()),t.appendChild(l)},this),this._syncScrollColumnWidths(),this._addScrollbarPadding())},_syncScrollUI:function(){var t=this._xScroll,e=this._yScroll,l=this._xScrollNode,i=this._yScrollNode,l=l&&l.get("scrollLeft"),i=i&&i.get("scrollTop");this._uiSetScrollable(),t||e?("%"===(this.get("width")||"").slice(-1)?this._bindScrollResize():this._unbindScrollResize(),this._syncScrollCaptionUI()):this._disableScrolling(),this._yScrollHeader&&this._yScrollHeader.setStyle("display","none"),t&&(e||this._disableYScrolling(),this._syncXScrollUI(e)),e&&(t||this._disableXScrolling(),this._syncYScrollUI(t)),l&&this._xScrollNode&&this._xScrollNode.set("scrollLeft",l),i&&this._yScrollNode&&this._yScrollNode.set("scrollTop",i)},_syncXScrollUI:function(t){var e,l=this._xScrollNode,i=this._yScrollContainer,o=this._tableNode,s=this.get("width"),r=this.get("boundingBox").get("offsetWidth"),a=S.DOM.getScrollbarWidth();l||(l=this._createXScrollNode(),(i||o).replace(l).appendTo(l)),i=g(l,"borderLeftWidth")+g(l,"borderRightWidth"),l.setStyle("width",""),this._uiSetDim("width",""),t&&this._yScrollContainer&&this._yScrollContainer.setStyle("width",""),S.UA.ie&&S.UA.ie<8&&(o.setStyle("width",s),o.get("offsetWidth")),o.setStyle("width",""),e=o.get("offsetWidth"),o.setStyle("width",e+"px"),this._uiSetDim("width",s),l.setStyle("width",r-i+"px"),l.get("offsetWidth")-i>e&&(t?o.setStyle("width",l.get("offsetWidth")-i-a+"px"):o.setStyle("width","100%"))},_syncYScrollUI:function(t){var e=this._yScrollContainer,l=this._yScrollNode,i=this._xScrollNode,o=this._yScrollHeader,s=this._scrollbarNode,r=this._tableNode,a=this._theadNode,c=this._captionTable,h=this.get("boundingBox"),n=this.get("contentBox"),d=this.get("width"),h=h.get("offsetHeight"),_=S.DOM.getScrollbarWidth();c&&!t&&c.setStyle("width",d||"100%"),e||(e=this._createYScrollNode(),l=this._yScrollNode,r.replace(e).appendTo(l)),i=t?i:e,t||r.setStyle("width",""),t&&(h-=_),l.setStyle("height",h-i.get("offsetTop")-g(i,"borderTopWidth")-g(i,"borderBottomWidth")+"px"),t?e.setStyle("width",r.get("offsetWidth")+_+"px"):this._uiSetYScrollWidth(d),c&&!t&&c.setStyle("width",e.get("offsetWidth")+"px"),a&&!o&&(o=this._createYScrollHeader(),e.prepend(o),this._syncScrollHeaders()),o&&(this._syncScrollColumnWidths(),o.setStyle("display",""),s||(s=this._createScrollbar(),this._bindScrollbar(),n.prepend(s)),this._uiSetScrollbarHeight(),this._uiSetScrollbarPosition(i))},_uiSetScrollable:function(){this.get("boundingBox").toggleClass(this.getClassName("scrollable","x"),this._xScroll).toggleClass(this.getClassName("scrollable","y"),this._yScroll)},_uiSetScrollbarHeight:function(){var t=this._scrollbarNode,e=this._yScrollNode,l=this._yScrollHeader;t&&e&&l&&(t.get("firstChild").setStyle("height",this._tbodyNode.get("scrollHeight")+"px"),t.setStyle("height",parseFloat(e.getComputedStyle("height"))-parseFloat(l.getComputedStyle("height"))+"px"))},_uiSetScrollbarPosition:function(t){var e=this._scrollbarNode,l=this._yScrollHeader;e&&t&&l&&e.setStyles({top:parseFloat(l.getComputedStyle("height"))+g(t,"borderTopWidth")+t.get("offsetTop")+"px",left:t.get("offsetWidth")-S.DOM.getScrollbarWidth()-1-g(t,"borderRightWidth")+"px"})},_uiSetYScrollWidth:function(t){var e,l,i=this._yScrollContainer,o=this._tableNode;i&&o&&(l=S.DOM.getScrollbarWidth(),t?(e=i.get("offsetWidth")-i.get("clientWidth")+l,i.setStyle("width",t),t=i.get("clientWidth")-e,o.setStyle("width",t+"px"),e=o.get("offsetWidth"),i.setStyle("width",e+l+"px")):(o.setStyle("width",""),i.setStyle("width",""),i.setStyle("width",o.get("offsetWidth")+l+"px")))},_unbindScrollbar:function(){this._scrollbarEventHandle&&this._scrollbarEventHandle.detach()},_unbindScrollResize:function(){this._scrollResizeHandle&&(this._scrollResizeHandle.detach(),delete this._scrollResizeHandle)}},!0),S.Base.mix(S.DataTable,[e])},"@VERSION@",{requires:["datatable-base","datatable-column-widths","dom-screen"],skinnable:!0});